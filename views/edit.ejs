<%- include('header') %>

<main class="container" style="max-width: 700px; margin-top: 40px; margin-bottom: 50px;">
    <div style="background: white; padding: 40px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
        <h2 style="color: var(--navy); margin-bottom: 25px; border-bottom: 2px solid var(--blue); padding-bottom: 10px;">
            Edit Tribute: <%= tribute.firstName %> <%= tribute.lastName %>
        </h2>
        
        <form action="/tribute/<%= tribute.id %>/edit" method="POST" enctype="multipart/form-data">
            <div style="display: flex; gap: 20px; margin-bottom: 15px;">
                <div style="flex: 1;">
                    <label style="display: block; font-weight: bold; margin-bottom: 5px;">First Name</label>
                    <input type="text" name="firstName" value="<%= tribute.firstName %>" required 
                           style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                </div>
                <div style="flex: 1;">
                    <label style="display: block; font-weight: bold; margin-bottom: 5px;">Last Name</label>
                    <input type="text" name="lastName" value="<%= tribute.lastName %>" required 
                           style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                </div>
            </div>

            <div style="margin-bottom: 15px;">
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Funeral Home / Location</label>
                <input type="text" name="funeralHome" value="<%= tribute.funeralHome %>" 
                       style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Biography / Obituary</label>
                <textarea id="bioTextArea" name="bio" rows="8" maxlength="1000" required 
                          style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; resize: vertical;"><%= tribute.bio %></textarea>
                <div id="charCount" style="text-align: right; font-size: 0.85rem; color: #666; margin-top: 5px;">
                    0 / 1000 characters
                </div>
            </div>
            
            <div style="margin-bottom: 25px;">
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Profile Photo</label>
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px;">
                    <img src="<%= tribute.photo %>" style="width: 60px; height: 60px; border-radius: 50%; object-fit: cover; border: 1px solid #ddd;">
                    <span style="font-size: 0.85rem; color: #666;">Current photo</span>
                </div>
                <input type="file" name="photo" accept="image/*" 
                       style="width: 100%; padding: 10px; background: #f9f9f9; border: 1px dashed #ccc; border-radius: 6px;">
                <p style="font-size: 0.8rem; color: #888; margin-top: 5px;">Leave empty to keep current photo.</p>
            </div>
            
            <div style="display: flex; gap: 10px;">
                <button type="submit" class="btn" style="flex: 2; padding: 15px; font-weight: bold;">
                    Save Changes
                </button>
                <a href="/admin" class="btn" style="flex: 1; padding: 15px; text-align: center; background: #95a5a6;">
                    Cancel
                </a>
            </div>
        </form>
    </div>
</main>

<script>
    const bioArea = document.getElementById('bioTextArea');
    const charDisplay = document.getElementById('charCount');
    const maxLength = 1000;

    function updateCount() {
        const length = bioArea.value.length;
        charDisplay.textContent = `${length} / ${maxLength} characters`;
    }

    bioArea.addEventListener('input', updateCount);
    window.onload = updateCount; // Set count on page load
</script>

<%- include('footer') %>